#### vue专题

1.vue如何判断图片已经加载完成？

(1)onerror监听图片加载失败，同理onload监听图片加载完成（vue里为@load）

```
<img :src="item.ImageUrl" @error="defImg()"/>

motheds:
defImg: function () {
    var img = event.srcElement ? event.srcElement : event.target;
    img.src = '../image/img_default_small.png';
    /*如果error的default图片也不存在，则会继续触发 onerror事件，导致死循环，故会出现打开网页时提示 Stack overflow at line: 0 错误。特别说明：如果图片存在，但网络很不通畅，也可能触发 onerror事件。
　　*解决方法：控制它不循环*/
    img.onerror = null;
},


或者
<img :src="item.ImageUrl" :onerror="动态路径"/>

data里用import或者require去引入相对路径

```

(2)利用promise

一个demo

```
const imgs = [
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000',
    'https://inews.gtimg.com/newsapp_bt/0/9906123226/1000'
];

function ready(pics) {
    const picsAll = pics.map((imgurl) => {
        imgurl = imgurl + '?v=' + Math.random(); // 仅是为了区分下不同的图片链接
        return new Promise((resolve, reject) => {
            const img = new Image();
            img.src = imgurl;
            img.onload = () => resolve(imgurl);
            img.onerror = () => reject(new Error(imgurl + ' load error'));
        })
    });
    Promise.all(picsAll).then(() => {
        console.log('load all success');
    }).catch((e) => {
        console.log(e);
    })
}
```

2.vue弹窗禁止穿透

```
@touchmove.prevent
```

### apiCloud专题

 https://docs.apicloud.com/Dev-Tools/wifi-debug 

### ArcGIS API for JavaScript 4.2学习笔记

 [https://www.cnblogs.com/onsummer/tag/ArcGIS%20API%20for%20Javascript/default.html?page=3](https://www.cnblogs.com/onsummer/tag/ArcGIS API for Javascript/default.html?page=3) 

#### 1.显示2D地图

假设vue中，先写一个function去initMap，在mounted去初始化

首先在html页面中肯定要有一个div，官方命名为“viewDiv”，我这里用id=“map”

```
initMap () {
	require
    (
        [
          "esri/Map",
          "esri/views/MapView",
          "dojo/domReady!"
        ] ,
        function(Map, MapView) {
            //你的代码
            var map = new Map({
            	basemap: "osm" // 基础地图类型
            });
            var view = new MapView({
                container: "map",  // 承接地图的块元素的ID
                map: map,  // 地图对象，由上方new出
                zoom: 8,  // 缩放级别
                center: [114, 30]  // 中心经纬度
            });
        }
    );
}
```

 代码解析：

1.1 两个实例化的对象map、view进行解释说明。

【map对象是地图的数据部分，而view则是地图的可视化部分。】

1.2 require入口函数  参数

第一个参数，引用数组。注意第一个参数引用的的图层要和第二个参数中也就是函数里的参数顺序一致

第二个参数是一个函数，函数体就是初始化地图的一些代码

map对象和view对象都是由上面Map和MapView类new实例化出来的。Map和MapView两个名词，是esri/Map模块和esri/views模块下的两个类而已。

1.3 basemap 作为最下面的地图，然后你可以在上面再叠加自己的图层 

官方文档 https://developers.arcgis.com/javascript/3/jsapi/esri.basemaps-amd.html 

踩坑：这17种basemap中只有8种可以通过上述代码的这种方式调用 （national-geographic,gray,hybrid,oceans,osm,satellite卫星图,streets,topo） ，剩余的暂时不知道调用方法

https://www.cnblogs.com/myfgis/p/5709079.html 

1.4 Map

 http://120.78.85.181:5051/doc/sdk47/api-reference/esri-Map.html 

继承自Accessor，子类有WebMap和WebScene。

构造函数的参数有一个：basemap类型的参数

1.5 MapView 2D地图

 http://120.78.85.181:5051/doc/sdk47/api-reference/esri-views-MapView.html 

继承自 MapView [View](http://120.78.85.181:5051/doc/sdk47/api-reference/esri-views-View.html) [Accessor](http://120.78.85.181:5051/doc/sdk47/api-reference/esri-core-Accessor.html) 

SceneView - Create a 3D map(后面介绍)

1.6 官方样式表和类库的引用，没有这俩运行不了

```oz
<link rel="stylesheet" href="https://js.arcgis.com/4.2/esri/css/main.css">
<script src="https://js.arcgis.com/4.2/"></script>
```

#### 2.显示3D地图

view对象不是MapView类了，而是SceneView类 

```
function(Map, SceneView){
  var map = new Map({
    basemap: "osm", 
    ground: "world-elevation"
  });//仍然使用osm基础地图
  var view = new SceneView({
    container: "map",     
    map: map,               
    scale: 50000000,         
    center: [113.5, 30] 
  });//比例尺为1：5000万
}
```

2.1 ground属性

 ground属性是表面数据，它可以是Ground类的实例 ，字符串“world-elevation”使用世界高程服务指定地面的一个实例 

#### 3.sample 样例

 http://120.78.85.181:5051/doc/sdk47/sample-code/webmap-basic/index.html 

【Get Started】

类似于绪论一样的东西，抽取了最需要关注的几个例子。如：加载Map和View，加载layers，使用弹出窗口，视觉化，与使用窗口小部件。

【Mapping and Views】 介绍地图（Map）和视图（View）的 

最基础的，知道地图和视图的区别，能使用2D和3D地图，对地图的布局有一定的了解，对地图的动画也有小小的使用示例。还介绍了2D3D视图同步、鹰眼、指北针等功能。这一章是最基础的了，其中第一小节介绍了入口函数的参数意义

别人写的例子 https://www.cnblogs.com/onsummer/p/6363914.html 

#### 4.官方API

【Layers】 

支持多图层叠加显示

支持要素图层、场景图层（直接把影像拔高，推出了一个盒子形状的立体物件的场景图层）、矢量瓦片图层（这个很厉害啊）、影像图层、流图层、CSV图层、OpenStreet地图图层、Web瓦片图层、点云图层（这个更厉害1.1亿的激光雷达点云数据都能加载进来）

其中，对MapImageLayer和ImageryLayer有着重的介绍，前者不知道是什么东西，后者是影像图层（栅格图层）。这也是数据中最关键的了。

最后我想问一下：图层这种东西，是怎么创建的（查API应该可以查到如何创建实例）？数据又如何从硬盘中获取？需要服务器环境吗？

回答上一句提到的问题。图层通过ArcGIS Server发布的各种服务创建，也可以通过Online或者Portal上的ID创建。

 https://www.cnblogs.com/onsummer/p/6363915.html 

#### 5.goTo()地图动画

 http://120.78.85.181:5051/doc/sdk47/sample-code/scene-goto/index.html 

 除了Map类和SceneView类，还多出来了query和on这俩，字面意思可以猜测是查询和事件有关 

```
require(
　　[
　　　　"esri/Map",
　　　　"esri/views/SceneView",
　　　　"dojo/query",
　　　　"dojo/on"
　　　　"dojo/domReady!"
　　]
　　function(Map,SceneView,query,on)
　　{
　　　　//你的代码
　　}
);
```

地图缩放动画的核心就是view对象的goTo()方法的使用。

goTo()方法在MapView类和SceneView类中都有提供，但是在它们的父类View类中没有

 https://www.cnblogs.com/onsummer/p/6388084.html 